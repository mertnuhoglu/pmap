
# Logs 20190607 

## setup nginx

Ref: `Setup nginx <url:/Users/mertnuhoglu/projects/itr/peyman/pvrp/doc/process_setup_peyman.md#tn=Setup nginx>`

Edit `~/projects/itr/vrp/nginx/nginx.conf`

### Error: git changes to be overwritten in the server side

Fix:

            proxy_pass https://peymandev.i-terative.com:5050;

->

            proxy_pass http://peymandev.i-terative.com:5050;

### error: https ile giriş yapınca oturum hemen kapanıyor

opt01: ssl'i iptal et

#### opt02: tutorial: Running RStudio Server with a Proxy

https://support.rstudio.com/hc/en-us/articles/200552326-Running-RStudio-Server-with-a-Proxy

``` bash
docker exec -it vrp_nginx-router_1 bash
``` 

e01: http_upgrade

Edit `~/projects/itr/vrp/nginx/nginx.conf`

``` bash
http {
  map $http_upgrade $connection_upgrade {
      default upgrade;
      ''      close;
    }
		...
``` 

rewrite:

``` bash
        location / {
            proxy_pass http://peymandev.i-terative.com:5050;
	      proxy_http_version 1.1;
	      proxy_set_header Upgrade $http_upgrade;
	      proxy_set_header Connection $connection_upgrade;
	      proxy_read_timeout 20d;
	}
``` 

It works fine.

## scriptleri ana klasöre taşı

Run `~/projects/itr/peyman/pmap/scripts/route_navigator.R`

## rota sürelerinin düzeltilmesi

`od_table` buradan geliyor: `~/projects/itr/peyman/pvrp/scripts/read_data.R`

``` tsv
from_point_id   to_point_id     duration        distance
1       2       18.48   13.9308
1       3       14.766666666666667      17.223
``` 

Bu distance verilerini iki misline çıkart

``` bash
cp ~/gdrive/mynotes/prj/itr/iterative_mert/peyman/gen/od_table.tsv ~/gdrive/mynotes/prj/itr/iterative_mert/peyman/gen/od_table0.tsv
``` 

``` r
od0 = readr::read_tsv("~/gdrive/mynotes/prj/itr/iterative_mert/peyman/gen/od_table0.tsv") 
od = od0 %>%
	dplyr::mutate(duration = 1.6 * duration)
readr::write_tsv(od, "~/gdrive/mynotes/prj/itr/iterative_mert/peyman/gen/od_table16.tsv")
``` 

### Run optimization: 

Follow: `~/projects/itr/peyman/pvrp/README.md`

Notes in `~/projects/itr/peyman/pvrp/doc/study/log_20190609.md`
